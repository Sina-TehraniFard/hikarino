# ヒカリノ Git運用ルールブック

## 1. ブランチ戦略

### メインブランチ
- `main`: 本番環境にデプロイするためのブランチです。リリース可能な状態だけを保持します。  
  （例: 本番サイトにすぐ反映させたいときに使います）  
  ※誤って未完成のコードが本番に入らないようにするためです。

- `develop`: 次のリリースに向けた開発作業をまとめるブランチです。  
  （例: 新機能や修正を一旦ここに集約して動作確認を行うときに使います）  
  ※開発の進捗を管理しやすくするためです。

### 作業用ブランチ
- `feature/*`: 新しい機能を開発するときに使います。  
  - 命名規則: `feature/機能名`  
  - 例: `feature/tarot-reading`  
  - 具体例: タロットカードの占い機能を追加するときに作成します。  
  ※機能ごとに作業を分けて管理しやすくするためです。

- `fix/*`: バグを修正するときに使います。  
  - 命名規則: `fix/修正内容`  
  - 例: `fix/login-error`  
  - 具体例: ログイン画面で発生したエラーを直すときに使います。  
  ※バグ修正を明確に分けて管理できるようにするためです。

- `hotfix/*`: 本番環境で緊急に修正が必要なときに使います。  
  - 命名規則: `hotfix/修正内容`  
  - 例: `hotfix/security-patch`  
  - 具体例: セキュリティ上の重大な問題をすぐ直すときに使います。  
  ※迅速に本番環境を安定させるためです。

## 2. コミットメッセージ規則

### Conventional Commits形式
```
<type>(<scope>): <description>

[optional body]

[optional footer]
```
この形式を使うことで、コミット内容がわかりやすくなり、後から変更履歴を追いやすくなります。

### コミットタイプ
- `feat`: 新しい機能を追加したときに使います。  
  例: `feat(tarot): タロットカードの表示機能を追加`  
  （タロット占い機能を新しく作った場合）  
  ※機能追加が一目でわかるようにするためです。

- `fix`: バグを修正したときに使います。  
  例: `fix(auth): ログイン時のエラーハンドリングを修正`  
  （ログイン時にエラーが正しく処理されなかった問題を直した場合）  
  ※バグ修正の履歴を明確にするためです。

- `refactor`: コードの見直しや整理をしたときに使います。  
  例: `refactor(tarot): タロットカード表示コードを整理`  
  ※動作は変えずにコードを改善したことを示すためです。

- `chore`: ビルドやツールの設定変更など、機能に直接関係ない変更に使います。  
  例: `chore(deps): 依存ライブラリのアップデート`、`chore(ci): CI設定を更新`  
  ※開発環境やCI/CDの管理をわかりやすくするためです。

- `docs`: ドキュメントだけを変更したときに使います。  
  例: `docs(readme): セットアップ手順を更新`  
  ※ドキュメントの変更を区別するためです。

- `test`: テストコードの追加や修正に使います。  
  例: `test(tarot): タロット機能の単体テストを追加`  
  ※テスト関連の変更を明確にするためです。

- `style`: コードの見た目だけを変えたときに使います（スペースやフォーマットなど）。  
  例: `style(tarot): インデントを修正`  
  ※動作に影響しない変更を区別するためです。

- `perf`: パフォーマンス改善を行ったときに使います。  
  例: `perf(tarot): 表示速度を改善`  
  ※性能向上の変更を明確にするためです。

## 3. プルリクエスト運用

### 基本方針
- ひとつの機能や修正ごとにPRを作成してください。  
- 自分でしっかりレビューしてから、他のメンバーにレビューを依頼します。  
- レビューが完了して問題がなければマージしてください。  
※品質を保ち、問題の混入を防ぐためです。

### PRテンプレート
- 変更内容の概要  
- 関連するIssue番号  
- テスト結果の報告  
- UI変更があればスクリーンショット添付  
これらを記載することで、レビューがスムーズになります。

## 4. タグとバージョン管理

### バージョン形式
- セマンティックバージョニング（例: `v1.0.0`）を使います。  
  - メジャー: 後方互換性のない大きな変更  
  - マイナー: 後方互換性のある機能追加  
  - パッチ: バグ修正  
※バージョン管理をわかりやすくするためです。

### semantic-release運用
- コミットメッセージに基づいて自動でバージョン管理を行います。  
- リリースノートも自動生成されます。  
- GitHubのリリースも自動で作成されます。  
※人為的ミスを減らし、リリース作業を効率化するためです。

## 5. 禁止事項

### ブランチ操作
- `main`ブランチへの直接pushは禁止です。  
  ※誤って未完成のコードが本番に反映されるのを防ぐためです。

- `force push`の使用は禁止です。  
  ※履歴が壊れて他のメンバーの作業に影響が出る可能性があるためです。

- 作業ブランチを長期間放置しないでください。  
  ※古いブランチが溜まると管理が難しくなり、コンフリクトも増えるためです。

### セキュリティ
- 機密情報をコミットするのは禁止です。  
  ※情報漏洩のリスクがあるためです。

- 環境変数の実際の値を直接コミットしないでください。  
  ※APIキーなどが漏れる危険があるためです。

## 6. その他

### 環境変数管理
- `.env.example`ファイルで環境変数のテンプレートを共有します。  
- 実際の値は`.env`ファイルで管理し、Gitには含めません。  
※セキュリティを保つための運用ルールです。

### ドキュメント管理
- `README.md`でプロジェクトの概要を管理してください。  
- 技術的な詳細は`docs/`ディレクトリにまとめて管理します。  
※情報を整理して共有しやすくするためです。

### 定期的なメンテナンス
- 古いブランチの削除を行います。  
- 依存関係の更新を定期的に実施します。  
- セキュリティアップデートを適用します。  
※プロジェクトを健全に保つための重要な作業です。